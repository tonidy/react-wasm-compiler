<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>React WASM Compiler - Compile React in Browser</title>

        <!-- Speed-Highlight Syntax Highlighting -->
        <link rel="stylesheet" href="https://unpkg.com/@speed-highlight/core/dist/themes/default.css">
        <script src="https://unpkg.com/@speed-highlight/core@2.7.1/dist/index.umd.js"></script>

        <!-- Import Map: React externals via esm.sh CDN -->
        <script type="importmap">
            {
                "imports": {
                    "react": "https://esm.sh/react@19.2.3",
                    "react/jsx-runtime": "https://esm.sh/react@19.2.3/jsx-runtime",
                    "react-dom": "https://esm.sh/react-dom@19.2.3",
                    "react-dom/client": "https://esm.sh/react-dom@19.2.3/client"
                }
            }
        </script>

        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family: system-ui, -apple-system, sans-serif;
                background: #000000;
                height: 100vh;
                overflow: hidden;
                color: #fafafa;
            }

            .ide-container {
                display: flex;
                flex-direction: column;
                height: 100vh;
            }

            .ide-header {
                background: #0a0a0a;
                padding: 16px 24px;
                border-bottom: 1px solid #27272a;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            }

            .ide-header h1 {
                font-size: 28px;
                color: #fafafa;
                font-weight: 700;
            }

            .compiler-selector {
                display: flex;
                gap: 12px;
                align-items: center;
            }

            .compiler-selector label {
                font-weight: 600;
                color: #e4e4e7;
            }

            .compiler-selector select {
                padding: 8px 14px;
                border: 1px solid #27272a;
                border-radius: 6px;
                font-size: 14px;
                background: #18181b;
                color: #fafafa;
                cursor: pointer;
                font-weight: 600;
                transition: all 0.3s ease;
            }

            .compiler-selector select:hover {
                border-color: #3f3f46;
                background: #27272a;
            }

            .theme-toggle {
                padding: 8px 12px;
                border: 1px solid #27272a;
                border-radius: 6px;
                background: #18181b;
                color: #fafafa;
                cursor: pointer;
                font-size: 18px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
                min-width: 44px;
                height: 40px;
            }

            .theme-toggle:hover {
                border-color: #3f3f46;
                background: #27272a;
            }

            .ide-main {
                display: grid;
                grid-template-columns: 250px 1fr 1fr;
                gap: 8px;
                padding: 8px;
                flex: 1;
                overflow: hidden;
            }

            /* File Explorer */
            .file-explorer {
                background: #09090b;
                border-radius: 8px;
                overflow-y: auto;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
                padding: 12px;
                border: 1px solid #27272a;
            }

            .file-explorer-title {
                font-weight: 700;
                color: #a1a1a6;
                font-size: 12px;
                text-transform: uppercase;
                margin-bottom: 12px;
                padding-bottom: 8px;
                border-bottom: 1px solid #27272a;
            }

            .file-tree {
                font-size: 13px;
                font-family: system-ui, -apple-system, sans-serif;
                letter-spacing: 0.3px;
            }

            .file-item {
                padding: 8px 8px;
                margin: 3px 0;
                cursor: pointer;
                border-radius: 4px;
                color: #d4d4d8;
                transition: all 0.2s ease;
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 13px;
                font-weight: 500;
            }

            .file-item:hover {
                background: #27272a;
            }

            .file-item.file {
                color: #a1a1a6;
                padding-left: 24px;
            }

            .file-item.file:hover {
                color: #e4e4e7;
                background: #27272a;
            }

            .file-item.active {
                background: #3f3f46;
                color: #fafafa;
                font-weight: 600;
            }

            .file-item.directory {
                cursor: pointer;
                user-select: none;
                color: #e4e4e7;
                font-weight: 600;
            }

            .file-item.directory:hover {
                background: #27272a;
            }

            .file-children {
                margin-left: 16px;
            }

            .file-children.collapsed {
                display: none;
            }

            /* Code Editor */
            .code-editor {
                background: #09090b;
                border-radius: 8px;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
                border: 1px solid #27272a;
            }

            .editor-header {
                background: #0a0a0a;
                padding: 8px 12px;
                border-bottom: 1px solid #27272a;
                font-size: 12px;
                font-weight: 600;
                color: #a1a1a6;
                text-transform: uppercase;
            }

            .editor-wrapper {
                flex: 1;
                position: relative;
                overflow: hidden;
            }

            .editor-highlight {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
                background: #09090b;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                line-height: 1.6;
                padding: 16px;
                pointer-events: none;
            }

            .editor-highlight code {
                display: block;
                background: none;
                padding: 0;
                margin: 0;
                color: inherit;
            }

            .editor-highlight pre {
                margin: 0;
                padding: 0;
                background: none;
            }

            .editor-textarea {
                position: relative;
                flex: 1;
                padding: 16px;
                border: none;
                outline: none;
                font-family: 'Monaco', 'Courier New', monospace;
                font-size: 13px;
                line-height: 1.6;
                color: transparent;
                background: transparent;
                resize: none;
                overflow-y: auto;
                caret-color: #e4e4e7;
                z-index: 10;
            }

            .editor-textarea::selection {
                background: rgba(63, 63, 70, 0.5);
            }

            /* Live Preview */
            .live-preview {
                background: #09090b;
                border-radius: 8px;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
                border: 1px solid #27272a;
            }

            .preview-header {
                background: #0a0a0a;
                padding: 8px 12px;
                border-bottom: 1px solid #27272a;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .preview-title {
                font-size: 12px;
                font-weight: 600;
                color: #a1a1a6;
                text-transform: uppercase;
            }

            .preview-status {
                font-size: 11px;
                padding: 4px 10px;
                border-radius: 4px;
                background: #27272a;
                color: #a1a1a6;
                font-weight: 600;
            }

            .preview-status.loading {
                background: #3f3f46;
                color: #fafafa;
            }

            .preview-status.success {
                background: #3f3f46;
                color: #86efac;
            }

            .preview-status.error {
                background: #3f3f46;
                color: #ff6b6b;
            }

            .preview-container {
                flex: 1;
                overflow: hidden;
                background: #fafafa;
            }

            #root {
                width: 100%;
                height: 100%;
            }

            #root iframe {
                width: 100%;
                height: 100%;
                border: none;
            }

            /* Scrollbar styling */
            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }

            ::-webkit-scrollbar-track {
                background: #09090b;
            }

            ::-webkit-scrollbar-thumb {
                background: #27272a;
                border-radius: 4px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: #3f3f46;
            }

            /* Light Theme */
            body.light-theme {
                background: #ffffff;
                color: #1f2937;
            }

            body.light-theme .ide-header {
                background: #f9fafb;
                border-bottom-color: #e5e7eb;
            }

            body.light-theme .ide-header h1 {
                color: #1f2937;
            }

            body.light-theme .compiler-selector label {
                color: #374151;
            }

            body.light-theme .compiler-selector select {
                background: #ffffff;
                border-color: #d1d5db;
                color: #1f2937;
            }

            body.light-theme .compiler-selector select:hover {
                border-color: #9ca3af;
                background: #f3f4f6;
            }

            body.light-theme .theme-toggle {
                background: #ffffff;
                border-color: #d1d5db;
                color: #1f2937;
            }

            body.light-theme .theme-toggle:hover {
                border-color: #9ca3af;
                background: #f3f4f6;
            }

            body.light-theme .file-explorer {
                background: #ffffff;
                border-color: #e5e7eb;
            }

            body.light-theme .file-explorer-title {
                color: #6b7280;
                border-bottom-color: #e5e7eb;
            }

            body.light-theme .file-item {
                color: #374151;
            }

            body.light-theme .file-item:hover {
                background: #f3f4f6;
            }

            body.light-theme .file-item.file {
                color: #6b7280;
            }

            body.light-theme .file-item.file:hover {
                color: #1f2937;
            }

            body.light-theme .file-item.active {
                background: #dbeafe;
                color: #0c4a6e;
            }

            body.light-theme .file-item.directory {
                color: #1f2937;
            }

            body.light-theme .file-item.directory:hover {
                background: #f3f4f6;
            }

            body.light-theme .code-editor {
                background: #ffffff;
                border-color: #e5e7eb;
            }

            body.light-theme .editor-header {
                background: #f9fafb;
                border-bottom-color: #e5e7eb;
                color: #6b7280;
            }

            body.light-theme .editor-highlight {
                background: #ffffff;
                color: #1f2937;
            }

            body.light-theme .editor-textarea {
                background: transparent;
                color: transparent;
                caret-color: #1f2937;
            }

            body.light-theme .editor-textarea::selection {
                background: rgba(191, 219, 254, 0.5);
            }

            body.light-theme .live-preview {
                background: #ffffff;
                border-color: #e5e7eb;
            }

            body.light-theme .preview-header {
                background: #f9fafb;
                border-bottom-color: #e5e7eb;
            }

            body.light-theme .preview-title {
                color: #6b7280;
            }

            body.light-theme .preview-status {
                background: #f3f4f6;
                color: #4b5563;
            }

            body.light-theme ::-webkit-scrollbar-track {
                background: #f9fafb;
            }

            body.light-theme ::-webkit-scrollbar-thumb {
                background: #d1d5db;
            }

            body.light-theme ::-webkit-scrollbar-thumb:hover {
                background: #9ca3af;
            }
        </style>
    </head>
    <body>
        <div class="ide-container">
            <!-- Header -->
            <div class="ide-header">
                <h1>React WASM Compiler</h1>
                <div class="compiler-selector">
                    <label for="compiler-select">Compiler:</label>
                    <select id="compiler-select">
                        <option value="esbuild">esbuild wasm</option>
                        <option value="swc">SWC wasm web</option>
                    </select>
                    <button id="theme-toggle" class="theme-toggle" title="Toggle theme">
                        ðŸŒ™
                    </button>
                </div>
            </div>

            <!-- Main IDE Area -->
            <div class="ide-main">
                <!-- File Explorer -->
                <div class="file-explorer">
                    <div class="file-explorer-title">File Explorer</div>
                    <div class="file-tree" id="file-tree"></div>
                </div>

                <!-- Code Editor -->
                <div class="code-editor">
                    <div class="editor-header" id="editor-header">entry.tsx</div>
                    <div class="editor-wrapper">
                        <pre class="editor-highlight"><code id="code-highlight"></code></pre>
                        <textarea
                            id="code-editor"
                            class="editor-textarea"
                            spellcheck="false"
                        ></textarea>
                    </div>
                </div>

                <!-- Live Preview -->
                <div class="live-preview">
                    <div class="preview-header">
                        <div class="preview-title">Live Preview</div>
                        <div id="preview-status" class="preview-status loading">
                            Initializing...
                        </div>
                    </div>
                    <div class="preview-container">
                        <div id="root"></div>
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="./playground.js"></script>
    </body>
</html>
